<md-card class="small">
  <h1>Maak je bestelling</h1>
  <p>Met deze tool kan je makkelijk de dichtste frituur vinden waar ze al jouw favoriete snacks hebben. Als extraatje kan je ook een handig briefje afdrukken om mee te nemen naar de frituur!</p>
</md-card>

<!-- Favorite Snacks Image Grid -->
<md-grid-list cols="3" rowHeight="5:3" gutterSize="7" class="quickpick">
  <md-grid-tile *ngFor="let snack of (snacks | filterBy: ['favorite']: true | sample: 6) ">

    <button md-raised-button
      (click)="pickSnack(snack.id)"
      [style.backgroundImage]="snack.image?'url('+ snack.image +')':''"
      [mdTooltip]="snack.name+' toevoegen'"
      mdTooltipPosition="below"
      color="accent">
      <span *ngIf="!snack.image">{{snack.name}}</span>
    </button>

  </md-grid-tile>
</md-grid-list>

<!-- Autocomplete snack search box -->

<md-card class="small search">
  <form class="snacks-form">
    <md-form-field color="accent" class="full-width">

      <button md-icon-button mdPrefix>
        <md-icon>search</md-icon>
      </button>

      <input mdInput placeholder="Snack" aria-label="Snack" [mdAutocomplete]="auto" [formControl]="snackCtrl">

      <button *ngIf="snackCtrl.value" mdSuffix md-icon-button aria-label="Reset" (click)="snackCtrl.reset()">
      <md-icon>close</md-icon>
    </button>
      
      <md-autocomplete #auto="mdAutocomplete">
        <md-option (onSelectionChange)="pickSnack(snack.id,$event)" *ngFor="let snack of filteredSnacks | async | orderBy: ['name']" [value]="snack.name">
            <span>{{snack.name}}</span> | <small>{{snack.type}}</small>
        </md-option>
      </md-autocomplete>

    </md-form-field>
  </form>
</md-card>

<div *ngIf="addedSnacks.length">

  <!-- Order List -->

  <md-card class="list small">
    <h2>Bestelling</h2>
    <md-list>

      <div *ngFor="let group of (addedSnacks | groupByImpure:'type' | pairs) ; let last = last">
        <h3 md-subheader>{{group[0]}}</h3>
        <md-list-item *ngFor="let snack of group[1]">

          <md-icon mdListIcon>check_box</md-icon>
          <span *ngIf="snack.count > 0">
            {{snack.count}}x 
            <span (click)="openDialog(snack)" class="link">
              {{snack.name}}
              <md-icon *ngIf="snack.image || snack.link">open_in_new</md-icon>
            </span>
          </span>

          <span class="spacer"></span>

          <button md-icon-button aria-label="1 toevoegen" (click)="editSnackCount(snack.id,snack.count+1)">
            <md-icon>add</md-icon>
          </button>
          <button md-icon-button aria-label="1 aftrekken" (click)="editSnackCount(snack.id,snack.count-1)">
            <md-icon>remove</md-icon>
          </button>
          <button md-icon-button aria-label="Verwijderen" color="warn" (click)="editSnackCount(snack.id,0)">
            <md-icon>delete</md-icon>
          </button>

        </md-list-item>
        <div *ngIf="!last">
          <md-divider></md-divider>
        </div>
      </div>

    </md-list>
    <md-card-actions>
      <button md-button (click)="print()">PRINT</button>
      <button md-button (click)="email()">EMAIL</button>
      <button md-button class="right" color="warn" (click)="resetOrder()">RESET</button>
    </md-card-actions>
  </md-card>

  <!-- Map -->

  <md-card class="full">
    <app-map [shops]="filteredShops" [heatmap]="true"></app-map>
  </md-card>

</div>